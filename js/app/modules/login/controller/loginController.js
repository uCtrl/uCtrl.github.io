/*! uCtrl-Website - v0.0.1 - 2014-11-28 */
"use strict";angular.module("loginModule").controller("loginModal",["$rootScope","$scope","$state",function(a,b,c){function d(){var a=[],c=[];Object.getOwnPropertyNames(b.user).forEach(function(a){b.user[a].length<1?c[c.length]=a:b.user[a]=validator.escape(b.user[a])}),c.length>0?a[a.length]=b.translate("RegisterInputMissing")+c.join(", ")+".":(validator.isAlphanumeric(b.user.username)||(a[a.length]=b.translate("RegisterWrongUsernameFormat")),validator.isAlpha(b.user.firstName)||(a[a.length]=b.translate("RegisterWrongFirstNameFormat")),validator.isAlpha(b.user.lastName)||(a[a.length]=b.translate("RegisterWrongLastNameFormat"))),(b.user.password1.length>0||b.user.password2.length>0)&&b.user.password1!==b.user.password2&&(a[a.length]=b.translate("RegisterWrongPassValidation")),a.length>0?b.passValidation=!1:(b.passValidation=!0,b.disableButtons=!0,a[0]=b.translate("RegisterSuccess")),b.validationMessages=a}function e(a,b){return!(""==a||"123456"!=b)}b.lang={en:{LoginUserAdnPassEmpty:"<strong>Warning!</strong> Username and/or password are empty.",LoginWrongConnexion:"<strong>Warning!</strong> Username and password do not match.",RegisterInputMissing:"Some input were missing: ",RegisterWrongUsernameFormat:"Wrong Username format only accept alphanumerical characters.",RegisterWrongFirstNameFormat:"Wrong First name format only accept alphabetic characters.",RegisterWrongLastNameFormat:"Wrong Last name format only accept alphabetic characters.",RegisterWrongPassValidation:"The password and the password validation were not he same.",RegisterSuccess:"Validation successful."},fr:{LoginUserAdnPassEmpty:"<strong>Attention!</strong> Le nom d'utilisateur et/ou le mot de passe ne sont pas remplis.",LoginWrongConnexion:"<strong>Attention!</strong> Le nom d'utilisateur et le mot de passe ne correspondent pas dans notre base de données.",RegisterInputMissing:"Certaines entrées sont manquantes : ",RegisterWrongUsernameFormat:"Le champ d'entrée du nom d'utilisateur accepte seulement les caractères alphanumériques.",RegisterWrongFirstNameFormat:"Le champ d'entrée du prénom accepte seulement les caractères alphabétiques.",RegisterWrongLastNameFormat:"Le champ d'entrée du nom de famille accepte seulement les caractères alphabétiques.",RegisterWrongPassValidation:"Le mot de passe ainsi que son champ de validation ne correspondent pas.",RegisterSuccess:"Validation réussie."}},b.translate=function(c){var d=a.getLang(),e=arrayObjectIndexOf(a.availableLanguage,d,"value");return-1==e&&(d="en"),b.lang[d][c]},a.currentUser="",a.currentSessionID="",b.user={username:"",password1:"",password2:"",firstName:"",lastName:""},b.passValidation=!0,b.validationMessages="",b.disableButtons=!1,b.templates=[{name:"login",url:"views/login/loginModal.html"},{name:"register",url:"views/login/registerModal.html"}],b.template=b.templates[0],b.register=function(){b.template=b.templates[1]},b.login=function(){b.template=b.templates[0]},b.portalRegister=function(){d(),b.passValidation&&b.portalConnect($("#registerUserNameUCtrl").val(),$("#registerPasswordUCtrl").val())},b.portalConnect=function(d,f){if(void 0===f||void 0===d){var g=$("#userNameUCtrl"),h=$("#passwordUCtrl");d=g.val(),f=h.val()}var i=$("#wrongPasswordUserAlert");return""==f||""==d?void i.html(b.translate("LoginUserAdnPassEmpty")).show():void(e(d,f)?(i.hide(),a.isLogged=!0,c.go("portal"),b.close()):i.html(b.translate("LoginWrongConnexion")).show())},b.close=function(){a.modalInstance.close()}}]);